<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.1"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Hexoqzf</title><meta description="java,技术分享,后端开发,支付框架,数据接口,算法,leetcode"><meta property="og:type" content="website"><meta property="og:title" content="辣椒の酱"><meta property="og:url" content="https://removeif.github.io/"><meta property="og:site_name" content="辣椒の酱"><meta property="og:description" content="java,技术分享,后端开发,支付框架,数据接口,算法,leetcode"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/removeif/removeif.github.io@latest/img/avatar.jpg"><meta property="article:author" content="removeif"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://cdn.jsdelivr.net/gh/removeif/removeif.github.io@latest/img/avatar.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://removeif.github.io/"},"headline":"辣椒の酱","image":["https://cdn.jsdelivr.net/gh/removeif/removeif.github.io@latest/img/avatar.jpg"],"author":{"@type":"Person","name":"removeif"},"description":"java,技术分享,后端开发,支付框架,数据接口,算法,leetcode"}</script><link rel="alternative" href="/atom.xml" title="Hexoqzf" type="application/atom+xml"><link rel="icon" href="https://cdn.jsdelivr.net/gh/removeif/removeif.github.io@latest/img/wico.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro|Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Microsoft YaHei:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&amp;amp;subset=latin,latin-ext|Inconsolata|Itim|Lobster.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-dark.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/removeif/removeif.github.io@v2.2.1/css/style.css"><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/gh/removeif/removeif.github.io@v2.2.1/js/globalUtils.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/removeif/removeif.github.io@v2.2.1/live2d/waifu.css"><script type="text/javascript" async src="https://cdn.jsdelivr.net/gh/removeif/removeif.github.io@v2.2.1/live2d/autoload.js"></script></head><body class="is-3-column has-navbar-fixed-top"><nav class="navbar navbar-main is-fixed-top"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="https://cdn.jsdelivr.net/gh/removeif/blog_image/img/2019/20191121122803.png" alt="Hexoqzf" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/tags/%E6%B3%95%E5%BE%8B/">律法</a><a class="navbar-item" href="/media">影音</a><a class="navbar-item" href="/album">相册</a><a class="navbar-item" href="/friend">友链</a><a class="navbar-item" href="/self-talking">碎碎念</a><a class="navbar-item" href="/message">留言</a><a class="navbar-item" href="/about">关于</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/removeif"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a><a class="navbar-item" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a></div></div></div></nav><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/removeif/removeif.github.io@v2.2.1/js/theme-setting.js"></script><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2018-08-30T16:00:00.000Z">2018-08-31</time><a class="commentCountImg" href="/2018/08/31/%E7%88%AC%E8%99%AB/%E5%85%B3%E4%BA%8E%E9%97%AE%E7%AD%94%E7%88%AC%E8%99%AB%E9%9C%80%E6%B1%82%E7%9A%84%E5%88%86%E6%9E%90/#comment-container"><span class="display-none-class">dabcc4a3ce15073c0c7fc8c891283737</span><img class="not-gallery-item" src="https://cdn.jsdelivr.net/gh/removeif/removeif.github.io@v2.2.1/img/chat.svg"> <span class="commentCount" id="dabcc4a3ce15073c0c7fc8c891283737"> 99+</span>    </a><span class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="link-muted" href="/categories/%E7%88%AC%E8%99%AB/">爬虫</a></span><span class="level-item">8 minutes read (About 1152 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/08/31/%E7%88%AC%E8%99%AB/%E5%85%B3%E4%BA%8E%E9%97%AE%E7%AD%94%E7%88%AC%E8%99%AB%E9%9C%80%E6%B1%82%E7%9A%84%E5%88%86%E6%9E%90/">关于问答爬虫需求的分析</a></h1><div class="content"><p>知乎爬虫</p>
<p>爬取话题</p>
<p>1、知乎根话题（<a href="https://www.zhihu.com/topic/19776749/hot）">https://www.zhihu.com/topic/19776749/hot）</a></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.zhihu.com/api/v4/topics/19776749/feeds/top_activity?include=data[?(target.type=topic_sticky_module)].target.data[?(target.type=answer)].target.content,relationship.is_authorized,is_author,voting,is_thanked,is_nothelp;data[?(target.type=topic_sticky_module)].target.data[?(target.type=answer)].target.is_normal,comment_count,voteup_count,content,relevant_info,excerpt.author.badge[?(type=best_answerer)].topics;data[?(target.type=topic_sticky_module)].target.data[?(target.type=article)].target.content,voteup_count,comment_count,voting,author.badge[?(type=best_answerer)].topics;data[?(target.type=topic_sticky_module)].target.data[?(target.type=people)].target.answer_count,articles_count,gender,follower_count,is_followed,is_following,badge[?(type=best_answerer)].topics;data[?(target.type=answer)].target.content,relationship.is_authorized,is_author,voting,is_thanked,is_nothelp;data[?(target.type=answer)].target.author.badge[?(type=best_answerer)].topics;data[?(target.type=article)].target.content,author.badge[?(type=best_answerer)].topics;data[?(target.type=question)].target.comment_count&amp;offset=5&amp;limit=10</span><br></pre></td></tr></table></figure>


<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.zhihu.com/api/v4/topics/19776749/feeds/top_activity?include=data[?(target.type=topic_sticky_module)].target.data[?(target.type=answer)].target.content,relationship.is_authorized,is_author,voting,is_thanked,is_nothelp;data[?(target.type=topic_sticky_module)].target.data[?(target.type=answer)].target.is_normal,comment_count,voteup_count,content,relevant_info,excerpt.author.badge[?(type=best_answerer)].topics;data[?(target.type=topic_sticky_module)].target.data[?(target.type=article)].target.content,voteup_count,comment_count,voting,author.badge[?(type=best_answerer)].topics;data[?(target.type=topic_sticky_module)].target.data[?(target.type=people)].target.answer_count,articles_count,gender,follower_count,is_followed,is_following,badge[?(type=best_answerer)].topics;data[?(target.type=answer)].target.content,relationship.is_authorized,is_author,voting,is_thanked,is_nothelp;data[?(target.type=answer)].target.author.badge[?(type=best_answerer)].topics;data[?(target.type=article)].target.content,author.badge[?(type=best_answerer)].topics;data[?(target.type=question)].target.comment_count&amp;limit=10&amp;after_id=4847.84338&amp;offset=5</span><br></pre></td></tr></table></figure></div><div class="level is-mobile is-flex"><div class="level-start"><div class="is-uppercase article-more button is-small size-small"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted mr-2" rel="tag" href="/tags/%E7%88%AC%E8%99%AB/">爬虫</a></div></div><div class="level-start"><div class="level-item has-text-grey is-size-7 is-hidden-mobile"><time datetime="2018-09-06T11:06:18.000Z"><i class="far fa-calendar-check"> 最后修改: </i>2018-09-06</time></div></div><div class="level-start"><div class="level-item"><a class="article-more button is-small size-small link-muted" href="/2018/08/31/%E7%88%AC%E8%99%AB/%E5%85%B3%E4%BA%8E%E9%97%AE%E7%AD%94%E7%88%AC%E8%99%AB%E9%9C%80%E6%B1%82%E7%9A%84%E5%88%86%E6%9E%90/#more"><i class="fas fa-book-reader has-text-grey"> </i>Read More&gt;&gt;</a></div></div></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2018-08-29T16:00:00.000Z">2018-08-30</time><a class="commentCountImg" href="/2018/08/30/linux/ubuntu%E4%BF%AE%E6%94%B9%E6%97%B6%E9%97%B4(%E4%BA%8C)/#comment-container"><span class="display-none-class">4d8ec0890ec9d2de62d427cd3f89a42d</span><img class="not-gallery-item" src="https://cdn.jsdelivr.net/gh/removeif/removeif.github.io@v2.2.1/img/chat.svg"> <span class="commentCount" id="4d8ec0890ec9d2de62d427cd3f89a42d"> 99+</span>    </a><span class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="link-muted" href="/categories/linux/">linux</a></span><span class="level-item">3 minutes read (About 469 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/08/30/linux/ubuntu%E4%BF%AE%E6%94%B9%E6%97%B6%E9%97%B4(%E4%BA%8C)/">ubuntu修改时区-timedatectl</a></h1><div class="content"><h3 id="检查与修改时区"><a href="#检查与修改时区" class="headerlink" title="检查与修改时区"></a>检查与修改时区</h3><h6 id="查看时区"><a href="#查看时区" class="headerlink" title="查看时区"></a>查看时区</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> date -R</span></span><br><span class="line">Wed, 10 Jan 2018 11:26:47 +0800shell</span><br></pre></td></tr></table></figure>
<h6 id="当前时间格式化输出"><a href="#当前时间格式化输出" class="headerlink" title="当前时间格式化输出"></a>当前时间格式化输出</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> date <span class="string">"+%Y-%m-%d %H:%M:%S"</span></span></span><br></pre></td></tr></table></figure></div><div class="level is-mobile is-flex"><div class="level-start"><div class="is-uppercase article-more button is-small size-small"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted mr-2" rel="tag" href="/tags/ntp/">ntp</a></div></div><div class="level-start"><div class="level-item has-text-grey is-size-7 is-hidden-mobile"><time datetime="2018-08-30T03:11:42.000Z"><i class="far fa-calendar-check"> 最后修改: </i>2018-08-30</time></div></div><div class="level-start"><div class="level-item"><a class="article-more button is-small size-small link-muted" href="/2018/08/30/linux/ubuntu%E4%BF%AE%E6%94%B9%E6%97%B6%E9%97%B4(%E4%BA%8C)/#more"><i class="fas fa-book-reader has-text-grey"> </i>Read More&gt;&gt;</a></div></div></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2018-08-29T16:00:00.000Z">2018-08-30</time><a class="commentCountImg" href="/2018/08/30/%E5%B7%A5%E5%85%B7/USB%E5%90%AF%E5%8A%A8%E7%9B%98%E5%88%B6%E4%BD%9CRufus/#comment-container"><span class="display-none-class">52abfb8c65d7210e80d233ee9e67f932</span><img class="not-gallery-item" src="https://cdn.jsdelivr.net/gh/removeif/removeif.github.io@v2.2.1/img/chat.svg"> <span class="commentCount" id="52abfb8c65d7210e80d233ee9e67f932"> 99+</span>    </a><span class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="link-muted" href="/categories/%E5%B7%A5%E5%85%B7/">工具</a></span><span class="level-item">a minute read (About 143 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/08/30/%E5%B7%A5%E5%85%B7/USB%E5%90%AF%E5%8A%A8%E7%9B%98%E5%88%B6%E4%BD%9CRufus/">USB启动盘制作Rufus</a></h1><div class="content"><p><strong>Rufus</strong></p>
<p><strong>Rufus</strong> 是一个开源免费的<strong>快速制作 U 盘系统启动盘</strong>和格式化 <a href="https://www.iplaysoft.com/tag/usb">USB</a> 的实用小工具，它可以快速把 ISO 格式的系统镜像文件快速制作成可引导的 USB <a href="https://www.iplaysoft.com/tag/%E5%90%AF%E5%8A%A8">启动</a>安装盘，支持 Windows 或 <a href="https://www.iplaysoft.com/os/linux-platform">Linux</a> 启动。Rufus 小巧玲珑，软件体积仅几百多 KB，然而麻雀虽小，它却五脏俱全，而且速度极快。</p>
<p>地址：<a href="http://rufus.akeo.ie/?locale=zh_CN">http://rufus.akeo.ie/?locale=zh_CN</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2018-08-29T16:00:00.000Z">2018-08-30</time><a class="commentCountImg" href="/2018/08/30/%E5%B7%A5%E5%85%B7/%E7%99%BE%E5%BA%A6%E7%BD%91%E7%9B%98%E4%B8%8B%E8%BD%BDproxyee-down/#comment-container"><span class="display-none-class">9afa0d244bd533a86a697a4efcd84f3c</span><img class="not-gallery-item" src="https://cdn.jsdelivr.net/gh/removeif/removeif.github.io@v2.2.1/img/chat.svg"> <span class="commentCount" id="9afa0d244bd533a86a697a4efcd84f3c"> 99+</span>    </a><span class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="link-muted" href="/categories/%E5%B7%A5%E5%85%B7/">工具</a></span><span class="level-item">2 minutes read (About 267 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/08/30/%E5%B7%A5%E5%85%B7/%E7%99%BE%E5%BA%A6%E7%BD%91%E7%9B%98%E4%B8%8B%E8%BD%BDproxyee-down/">百度网盘下载proxyee-down</a></h1><div class="content"><p><strong>Proxyee-down</strong></p>
<p>这款开源工具可帮助我们构建网页代理嗅探百度下载地址，嗅探后的地址直接在网页建立多个连接加速下载。</p>
<p>实测该工具在百兆带宽下下载速度可以达到6~9MB每秒。</p>
<p>开源项目地址：<a href="https://github.com/monkeyWie/proxyee-down">https://github.com/monkeyWie/proxyee-down</a> </p>
<p>1、下载proxyee-down压缩包后，  运行proxyee-down.exe</p>
<p>2、安装SwitchyOmega插件（Firefox或chrome）</p>
<p>3、然后在chrome中进入百度云，选择要下载的文件，就正常点击下载就好了。</p>
<p>此时会调用Proxyee-down。</p>
<p>解释：可以把proxyee-down理解为一个下载器，正常下载会调用chrome的内置下载器，而SwitchyOmega会引导你的chrome打开proxyee-down进行下载，简单的运行原理就是如此。</p>
<p>其它：</p>
<p>另一工具：<a href="https://github.com/iikira/BaiduPCS-Go">BaiduPCS-Go</a></p>
<p>参考：<a href="https://github.com/proxyee-down-org/proxyee-down">proxyee-down</a></p>
<pre><code> [SwitchyOmega插件安装与设置](https://github.com/proxyee-down-org/proxyee-down/blob/v2.5/.guide/common/switchy/read.md)

[doub.io 需fq](https://doub.io/dbrj-9/)</code></pre></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2018-08-28T16:00:00.000Z">2018-08-29</time><a class="commentCountImg" href="/2018/08/29/java/Spring-Boot/Spring-boot%E9%83%A8%E7%BD%B2/#comment-container"><span class="display-none-class">b8c529c06d6f5192274172df6ea92ded</span><img class="not-gallery-item" src="https://cdn.jsdelivr.net/gh/removeif/removeif.github.io@v2.2.1/img/chat.svg"> <span class="commentCount" id="b8c529c06d6f5192274172df6ea92ded"> 99+</span>    </a><span class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="link-muted" href="/categories/Spring-boot/">Spring-boot</a></span><span class="level-item">3 minutes read (About 481 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/08/29/java/Spring-Boot/Spring-boot%E9%83%A8%E7%BD%B2/">Spring-boot部署</a></h1><div class="content"><p>spring-boot打包jar文件</p>
<h3 id="使用nohup命令使其后台运行"><a href="#使用nohup命令使其后台运行" class="headerlink" title="使用nohup命令使其后台运行"></a>使用nohup命令使其后台运行</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> nohup /usr/<span class="built_in">local</span>/java/bin/java -jar /opt/bootapp/spring-boot-1.0-SNAPSHOT.jar &gt; log.file 2&gt;&amp;1 &amp;</span></span><br></pre></td></tr></table></figure>



<h3 id="作为系统init-d服务安装"><a href="#作为系统init-d服务安装" class="headerlink" title="作为系统init.d服务安装"></a><code>作为系统init.d服务安装</code></h3><p>参考：<a href="https://docs.spring.io/spring-boot/docs/2.0.4.RELEASE/reference/htmlsingle/#deployment-initd-service">deployment-initd-service</a></p>
<h3 id="作为系统systemd服务安装"><a href="#作为系统systemd服务安装" class="headerlink" title="作为系统systemd服务安装"></a>作为系统<code>systemd</code>服务安装</h3><p><code>systemd</code>是System V init系统的后继者，现在许多现代Linux发行版都在使用它。虽然可以继续使用<code>init.d</code>脚本 <code>systemd</code>，但也可以使用<code>systemd</code> “服务”脚本启动Spring Boot应用程序。</p>
<h5 id="创建Systemd-service文件"><a href="#创建Systemd-service文件" class="headerlink" title="创建Systemd service文件"></a>创建Systemd service文件</h5><p>在/etc/systemd/system<code>目录中新建</code>bootapp.service  (bootapp可任意) 文件。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=myapp-cpnsp</span><br><span class="line">After=syslog.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">WorkingDirectory=/opt/bootapp</span><br><span class="line">ExecStart=/opt/java/jdk1.8.0_101/bin/java -jar /opt/bootapp/cpnsp-api-1.0.0-SNAPSHOT.jar</span><br><span class="line">ExecStop=/bin/kill $MAINPID</span><br><span class="line">SuccessExitStatus=143</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>

<p><code>ExecStart</code>可以写执行命令，也可以写脚本所在路径。</p>
<p>可进一步丰富此配置，可增加 <code>Group</code>、<code>User</code>、<code>Restart</code> 等配置 jar 包的执行用户组。</p>
<p>注意，与作为<code>init.d</code>服务运行时不同，运行应用程序的用户，PID文件和控制台日志文件由其<code>systemd</code>自身管理，因此必须使用“服务”脚本中的相应字段进行配置。有关更多详细信息，请参阅 <a href="https://www.freedesktop.org/software/systemd/man/systemd.service.html">服务单元配置手册页</a>。</p>
<h5 id="整合到systemctl"><a href="#整合到systemctl" class="headerlink" title="整合到systemctl"></a>整合到systemctl</h5><ul>
<li><p>添加到systemctl</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> systemctl <span class="built_in">enable</span> bootapp.service</span></span><br><span class="line">Created symlink /etc/systemd/system/multi-user.target.wants/bootapp.service → /etc/systemd/system/bootapp.service.</span><br></pre></td></tr></table></figure>
</li>
<li><p>启动</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> systemctl start bootapp.service</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>其它可用命令：<code>status</code>、<code>stop</code> 等，具体可参见 <code>Systemd</code> 文档</p>
</li>
<li><p>重新加载bootapp.service文件  (修改bootapp.service后执行)</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> systemctl daemon-reload</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>查看项目日志：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> journalctl -u bootapp</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> journalctl -u bootapp service</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>参考：<a href="https://docs.spring.io/spring-boot/docs/2.0.4.RELEASE/reference/htmlsingle/#deployment-service">deployment-service</a> </p>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.service.html">systemd.service</a>、<a href="https://www.v2ex.com/t/478762">spring-boot jar包的运行方式</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2018-08-23T16:00:00.000Z">2018-08-24</time><a class="commentCountImg" href="/2018/08/24/%E6%9C%8D%E5%8A%A1%E5%99%A8/ubuntu/18.04/ubuntu-server%E4%B8%AD%E9%85%8D%E7%BD%AE%E9%9D%99%E6%80%81IP/#comment-container"><span class="display-none-class">3baf08160d324204579ca7667c11ca8b</span><img class="not-gallery-item" src="https://cdn.jsdelivr.net/gh/removeif/removeif.github.io@v2.2.1/img/chat.svg"> <span class="commentCount" id="3baf08160d324204579ca7667c11ca8b"> 99+</span>    </a><span class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="link-muted" href="/categories/ubuntu/">ubuntu</a></span><span class="level-item">2 minutes read (About 300 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/08/24/%E6%9C%8D%E5%8A%A1%E5%99%A8/ubuntu/18.04/ubuntu-server%E4%B8%AD%E9%85%8D%E7%BD%AE%E9%9D%99%E6%80%81IP/">ubuntu 18.04 server中配置静态IP</a></h1><div class="content"><p>ubuntu 18.04 server中配置静态IP，新的网络工具netplan的使用方法</p>
<p>最新发布的ubuntu18.04 server，启用了新的网络工具netplan，对于命令行配置网络参数跟之前的版本有比较大的差别，现在介绍如下： 1.其网络配置文件是放在/etc/netplan/50-cloud-init.yaml, 缺省是用dhcp方式，</p>
<p>如下：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">network:</span></span><br><span class="line">    <span class="attr">ethernets:</span></span><br><span class="line">        <span class="attr">enp1s0:</span></span><br><span class="line">            <span class="attr">addresses:</span> <span class="string">[]</span></span><br><span class="line">            <span class="attr">dhcp4:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">version:</span> <span class="number">2</span></span><br></pre></td></tr></table></figure>



<p>如果要配置静态地址，则需要修改此文件的想关内容，见如下的例子：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">network:</span></span><br><span class="line">    <span class="attr">ethernets:</span></span><br><span class="line">        <span class="attr">enp1s0:</span></span><br><span class="line">            <span class="attr">addresses:</span> <span class="string">[192.168.1.80/24]</span></span><br><span class="line">            <span class="attr">dhcp4:</span> <span class="literal">false</span></span><br><span class="line">            <span class="attr">gateway4:</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.2</span></span><br><span class="line">            <span class="attr">nameservers:</span></span><br><span class="line">               <span class="attr">addresses:</span> <span class="string">[192.168.1.2]</span></span><br><span class="line">    <span class="attr">version:</span> <span class="number">2</span></span><br></pre></td></tr></table></figure>



<p>使其生效：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sudo netplan apply</span></span><br></pre></td></tr></table></figure>



<p>如果配置有问题会报错，如果没问题，则会新的配置会立即生效。  </p>
<p>注意：只是针对ubuntu18.04 Server版，对于18.04 desktop它缺省是使用NetworkManger来进行管理，可使用图形界面进行配置，其网络配置文件是保存在：/etc/NetworkManager/system-connections目录下的，跟Server版区别还是比较大的。  netplan 工具还有其它比较丰富的功能，</p>
<p>详细可参见其的说明文档，man netplan.</p>
<p>参考：<a href="http://forum.ubuntu.org.cn/viewtopic.php?t=487463">http://forum.ubuntu.org.cn/viewtopic.php?t=487463</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2018-08-22T16:00:00.000Z">2018-08-23</time><a class="commentCountImg" href="/2018/08/23/%E6%9C%8D%E5%8A%A1%E5%99%A8/ubuntu/ubuntuServer%E7%BB%88%E7%AB%AF%E4%B8%AD%E6%96%87%E8%8F%B1%E5%BD%A2%E4%B9%B1%E7%A0%81/#comment-container"><span class="display-none-class">6d855a25e4acc3ab150ddbd7728e32ba</span><img class="not-gallery-item" src="https://cdn.jsdelivr.net/gh/removeif/removeif.github.io@v2.2.1/img/chat.svg"> <span class="commentCount" id="6d855a25e4acc3ab150ddbd7728e32ba"> 99+</span>    </a><span class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="link-muted" href="/categories/ubuntu/">ubuntu</a></span><span class="level-item">a minute read (About 216 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/08/23/%E6%9C%8D%E5%8A%A1%E5%99%A8/ubuntu/ubuntuServer%E7%BB%88%E7%AB%AF%E4%B8%AD%E6%96%87%E8%8F%B1%E5%BD%A2%E4%B9%B1%E7%A0%81/">ubuntu Server终端中文菱形乱码</a></h1><div class="content"><p>ubuntu Server 安装过程中选择的中文，安装完成后，系统默认的语言将会是中文zh_CN.UTF-8。 但在终端下无法正常的显示默认中文编码zh_CN.UTF-8。 </p>
<p>解决方法：</p>
<p>第一种、*<em>使用putty、securteCRT等虚拟终端软件 *</em></p>
<p>直接修改虚拟终端界面配置项目中的字体编码为UTF-8即可 。但在实际终端下，仍然无法正常显示 汉字。</p>
<p>第二种、<strong>把系统转成英文的</strong> </p>
<p>修改/etc/default/locale 文件,将内容改为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">LANG&#x3D;”en_US.UTF-8″</span><br><span class="line">LANGUAGE&#x3D;”en_US:en”</span><br></pre></td></tr></table></figure>

<p>再运行：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sudo locale-gen -en_US:en</span></span><br></pre></td></tr></table></figure>

<p>然后重启，会提示是否将文件夹改成英文的，此时选择“Update…”即可 。</p>
<p>第三种、<strong>安装zhcon软件包</strong> </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sudo apt-get install zhcon</span></span><br></pre></td></tr></table></figure>



</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2018-08-22T16:00:00.000Z">2018-08-23</time><a class="commentCountImg" href="/2018/08/23/%E6%9C%8D%E5%8A%A1%E5%99%A8/ubuntu/18.04/ubuntu-desktop%E4%B8%AD%E9%97%AE%E9%A2%98/#comment-container"><span class="display-none-class">97aea99ad6055907a5a975c8226c6f8c</span><img class="not-gallery-item" src="https://cdn.jsdelivr.net/gh/removeif/removeif.github.io@v2.2.1/img/chat.svg"> <span class="commentCount" id="97aea99ad6055907a5a975c8226c6f8c"> 99+</span>    </a><span class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="link-muted" href="/categories/ubuntu/">ubuntu</a></span><span class="level-item">a minute read (About 213 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/08/23/%E6%9C%8D%E5%8A%A1%E5%99%A8/ubuntu/18.04/ubuntu-desktop%E4%B8%AD%E9%97%AE%E9%A2%98/">ubuntu-18.04-desktop问题</a></h1><div class="content"><p>ubuntu-18.04-desktop中遇到的问题（最小化安装 ）</p>
<p>1、休眠后无法唤醒</p>
<p>休眠后，就进不去系统了，目前解决办法是在设置里禁止休眠。</p>
<p>2、ifconfig命令not found</p>
<p>搜索说是ifconfig被抛弃了，被ip命令取代了。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ip address</span></span><br></pre></td></tr></table></figure>

<p>可缩写为</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ip a</span></span><br></pre></td></tr></table></figure>

<p>可参考：<a href="https://www.sunzhongwei.com/ubuntu-1804-ifconfig-command-not-found?from=sidebar_related">https://www.sunzhongwei.com/ubuntu-1804-ifconfig-command-not-found?from=sidebar_related</a></p>
<p>​                <a href="https://news.ycombinator.com/item?id=17151046">https://news.ycombinator.com/item?id=17151046</a></p>
<p>方法二：可安装net-tools ，继续使用ifconfig</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> apt-get install net-tools</span></span><br></pre></td></tr></table></figure>

<p>3、ssh连不上</p>
<p>原因是ubuntu18.04默认没有安装ssh服务 。</p>
<p>使用一下命令进行安装：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sudo apt-get install openssh-server</span></span><br></pre></td></tr></table></figure>

<p>安装完成后,启动ssh服务 </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> sudo /etc/init.d/ssh start</span></span><br></pre></td></tr></table></figure>

<p>查看ssh进程，若出现sshd，说明启动成功</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ps -ef|grep ssh</span></span><br></pre></td></tr></table></figure>

<p>可参考：<a href="https://segmentfault.com/a/1190000015872297">https://segmentfault.com/a/1190000015872297</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2018-08-19T16:00:00.000Z">2018-08-20</time><a class="commentCountImg" href="/2018/08/20/elasticsearch/elastic-stack/#comment-container"><span class="display-none-class">8f70fe7e3eef168b7732a948be3b8835</span><img class="not-gallery-item" src="https://cdn.jsdelivr.net/gh/removeif/removeif.github.io@v2.2.1/img/chat.svg"> <span class="commentCount" id="8f70fe7e3eef168b7732a948be3b8835"> 99+</span>    </a><span class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="link-muted" href="/categories/Elasticsearch/">Elasticsearch</a></span><span class="level-item">a minute read (About 177 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/08/20/elasticsearch/elastic-stack/">elastic-stack</a></h1><div class="content"><p>elastic-stack</p>
<p>Elastic Stack能够以任何格式可靠的，安全地从任何来源获取数据，并实时搜索，分析和可视化。 </p>
<p>由ELK (Elasticsearch、Logstash以及Kibana) +Beats 组成。</p>
<p>目前Beats包含六种工具： </p>
<ul>
<li>Packetbeat： 网络数据（收集网络流量数据）</li>
<li>Metricbeat： 指标 （收集系统、进程和文件系统级别的 CPU 和内存使用情况等数据）</li>
<li>Filebeat： 日志文件（收集文件数据）</li>
<li>Winlogbeat： windows事件日志（收集 Windows 事件日志数据）</li>
<li>Auditbeat：审计数据 （收集审计日志）</li>
<li>Heartbeat：运行时间监控 （收集系统运行时的数据）</li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2018-08-14T16:00:00.000Z">2018-08-15</time><a class="commentCountImg" href="/2018/08/15/java/websocket/springboot%E9%9B%86%E6%88%90websocket%E4%BD%BF%E7%94%A8rabbitmq/#comment-container"><span class="display-none-class">23293f5752b28dfd4498737a5784d7ad</span><img class="not-gallery-item" src="https://cdn.jsdelivr.net/gh/removeif/removeif.github.io@v2.2.1/img/chat.svg"> <span class="commentCount" id="23293f5752b28dfd4498737a5784d7ad"> 99+</span>    </a><span class="level-item"><i class="fas fa-folder-open has-text-grey"> </i><a class="link-muted" href="/categories/webscoket/">webscoket</a></span><span class="level-item">9 minutes read (About 1375 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2018/08/15/java/websocket/springboot%E9%9B%86%E6%88%90websocket%E4%BD%BF%E7%94%A8rabbitmq/">Springboot集成websocket并使用RabbitMQ做为消息代理</a></h1><div class="content"><p>首先RabbitMQ启用rabbitmq_web_stomp插件 </p>
<p>RabbitMQ启用rabbitmq_web_stomp插件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> rabbitmq-plugins <span class="built_in">enable</span> rabbitmq_web_stomp</span></span><br></pre></td></tr></table></figure>

<p>默认端口为：61613</p>
<h4 id="Springboot配置"><a href="#Springboot配置" class="headerlink" title="Springboot配置"></a>Springboot配置</h4><p>1、pom.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-websocket<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.projectreactor.ipc<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>reactor-netty<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.netty<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>netty-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.1.2.Final<span class="tag">&lt;/<span class="name">version</span>&gt;</span> </span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2、WebSocketMessageBrokerConfigurer配置</p>
<p>配置外部Rabibitmq替代Simple Broker做消息代理 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableWebSocketMessageBroker</span>   <span class="comment">//开启使用STOMP协议来传输基于代理（message broker）的消息</span></span><br><span class="line"><span class="comment">//这时控制器支持使用@MessageMapping，就像使用@RequestMapping一样</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebSocketConfig</span> <span class="keyword">implements</span> <span class="title">WebSocketMessageBrokerConfigurer</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger logger = LoggerFactory.getLogger(WebSocketConfig<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SessionCookieHelper sessionCookieHelper;</span><br><span class="line">   </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 注册 Stomp的端点</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">registerStompEndpoints</span><span class="params">(StompEndpointRegistry registry)</span> </span>&#123;</span><br><span class="line">		registry.addEndpoint(<span class="string">"/portfolio"</span>)<span class="comment">// 添加STOMP协议的端点。</span></span><br><span class="line">         .setAllowedOrigins(<span class="string">"*"</span>)<span class="comment">// 添加允许跨域访问</span></span><br><span class="line">		.addInterceptors(<span class="keyword">new</span> WebSocketSessionHandshakeInterceptor())</span><br><span class="line">	     <span class="comment">//.setHandshakeHandler(new DefaultHandshakeHandler())</span></span><br><span class="line">		.withSockJS();<span class="comment">//指定使用SockJS协议</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * 配置消息代理(message broker)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">configureMessageBroker</span><span class="params">(MessageBrokerRegistry registry)</span> </span>&#123; </span><br><span class="line">		registry.setApplicationDestinationPrefixes(<span class="string">"/app"</span>)</span><br><span class="line">		    <span class="comment">//.enableSimpleBroker("/topic", "/queue");//使用内置代理</span></span><br><span class="line">			.enableStompBrokerRelay(<span class="string">"/exchange"</span>,<span class="string">"/topic"</span>,<span class="string">"/queue"</span>,<span class="string">"/amq/queue"</span>)<span class="comment">//处理所有消息将消息发送到外部的消息代理  rabbitmq</span></span><br><span class="line">			.setRelayHost(<span class="string">"192.168.1.90"</span>)</span><br><span class="line">			.setRelayPort(<span class="number">61613</span>)</span><br><span class="line">			.setVirtualHost(<span class="string">"/eyeshot"</span>);</span><br><span class="line">			<span class="comment">//.setUserDestinationBroadcast(destination)</span></span><br><span class="line">         <span class="comment">//registry.setUserDestinationPrefix("/user");//推送用户前缀</span></span><br><span class="line">		<span class="comment">// registry.setPathMatcher(new AntPathMatcher(".")); //设置路径分隔符</span></span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>3、设置握手拦截器</p>
<p>只在进行连接的时候进行拦截</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebSocketSessionHandshakeInterceptor</span> <span class="keyword">extends</span> <span class="title">HttpSessionHandshakeInterceptor</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger logger = LoggerFactory.getLogger(WebSocketSessionHandshakeInterceptor<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">beforeHandshake</span><span class="params">(ServerHttpRequest request, ServerHttpResponse response, WebSocketHandler wsHandler, Map&lt;String, Object&gt; attributes)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (getSession(request) != <span class="keyword">null</span>) &#123;</span><br><span class="line">          ServletServerHttpRequest servletRequest = (ServletServerHttpRequest) request;</span><br><span class="line">          HttpServletRequest httpServletRequest = servletRequest.getServletRequest();httpServletRequest.getUserPrincipal();</span><br><span class="line">          List&lt;String&gt; requestCookies = servletRequest.getHeaders().get(<span class="string">"cookie"</span>);</span><br><span class="line">          <span class="keyword">for</span> (String string : requestCookies) &#123;</span><br><span class="line">						String[] cookies =  string.split(<span class="string">";"</span>);</span><br><span class="line">						<span class="keyword">for</span> (String cookie : cookies) &#123;</span><br><span class="line">							String[] item = cookie.split(<span class="string">"="</span>);</span><br><span class="line">							<span class="keyword">if</span>(item[<span class="number">0</span>].equals(<span class="string">"sessionToken"</span>)) &#123;</span><br><span class="line">								System.out.println(item[<span class="number">1</span>]);</span><br><span class="line">								attributes.put(<span class="string">"sessionToken"</span>, item[<span class="number">1</span>]);</span><br><span class="line">							&#125;</span><br><span class="line">							</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">          HttpSession session = httpServletRequest.getSession(<span class="keyword">false</span>);</span><br><span class="line">          <span class="keyword">if</span> (session != <span class="keyword">null</span>) &#123;</span><br><span class="line">            attributes.put(<span class="string">"sessionId"</span>, session.getId());</span><br><span class="line">          &#125;</span><br><span class="line">          attributes.put(<span class="string">"user"</span>, session.getId());</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">super</span>.beforeHandshake(request, response, wsHandler, attributes);</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterHandshake</span><span class="params">(ServerHttpRequest request, ServerHttpResponse response, WebSocketHandler wsHandler, Exception ex)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">super</span>.afterHandshake(request, response, wsHandler, ex);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">private</span> HttpSession <span class="title">getSession</span><span class="params">(ServerHttpRequest request)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (request <span class="keyword">instanceof</span> ServletServerHttpRequest) &#123;</span><br><span class="line">          ServletServerHttpRequest serverRequest = (ServletServerHttpRequest) request;</span><br><span class="line">          <span class="keyword">return</span> serverRequest.getServletRequest().getSession();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>4、自定义拦截器</p>
<p>可以对客户端的任何消息拦截</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 注册自定义身份验证拦截器</span></span><br><span class="line"><span class="comment">	 * 拦截器只需要在CONNECT上进行身份验证并设置用户头Message。Spring将记录并保存经过身份验证的用户，并将其与同一会话中的后续STOMP消息相关联</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	 <span class="meta">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">configureClientInboundChannel</span><span class="params">(ChannelRegistration registration)</span> </span>&#123;</span><br><span class="line">       registration.interceptors(<span class="keyword">new</span> ChannelInterceptorAdapter() &#123;</span><br><span class="line">           <span class="meta">@Override</span></span><br><span class="line">           <span class="keyword">public</span> Message&lt;?&gt; preSend(Message&lt;?&gt; message, MessageChannel channel) &#123;</span><br><span class="line">               StompHeaderAccessor accessor =</span><br><span class="line">                       MessageHeaderAccessor.getAccessor(message, StompHeaderAccessor<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">               accessor.getSessionAttributes().get(<span class="string">"sessionToken"</span>);</span><br><span class="line">               <span class="keyword">if</span> (StompCommand.CONNECT.equals(accessor.getCommand())) &#123;</span><br><span class="line">              	   String nickName = accessor.getNativeHeader(<span class="string">"nickName"</span>) != <span class="keyword">null</span> ? accessor.getNativeHeader(<span class="string">"nickName"</span>).get(<span class="number">0</span>) : <span class="string">"游客"</span>+accessor.getSessionId();</span><br><span class="line">                   Principal user = <span class="keyword">new</span> MyPrincipal(nickName) ; <span class="comment">// access authentication header(s)</span></span><br><span class="line">                   accessor.setUser(user);</span><br><span class="line">               &#125;</span><br><span class="line">               <span class="keyword">return</span> message;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.security.Principal;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyPrincipal</span> <span class="keyword">implements</span> <span class="title">Principal</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String nickName;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">MyPrincipal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">MyPrincipal</span><span class="params">(String nickName)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.nickName = nickName;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> nickName;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>然后在客户端进行连接时，在headers中把用户的nickName传入,在拦截器中加入认证Principal，使后续对用户的时间进行监听。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">connect</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    	 <span class="keyword">var</span> headers = &#123;</span><br><span class="line">    			 sessionId: <span class="string">'111'</span>,</span><br><span class="line">    		      passcode: <span class="string">'mypasscode'</span>,</span><br><span class="line">    		      <span class="comment">// additional header</span></span><br><span class="line">    		      <span class="string">'sessionId'</span>: <span class="string">'my-client-id'</span>,</span><br><span class="line">    		      <span class="string">'nickName'</span> : <span class="string">'大虾'</span></span><br><span class="line">    		    &#125;;</span><br><span class="line">        <span class="keyword">var</span> socket = <span class="keyword">new</span> SockJS(<span class="string">"/eyeshot/portfolio"</span>);<span class="comment">//连接SockJS的endpoint名称为"/portfolio"</span></span><br><span class="line">        stompClient = Stomp.over(socket);<span class="comment">//使用STOMP子协议的WebSocket客户端</span></span><br><span class="line">        stompClient.connect(headers, <span class="function"><span class="keyword">function</span> (<span class="params">frame</span>) </span>&#123;<span class="comment">//连接WebSocket服务端</span></span><br><span class="line">		   stompClient.subscribe(<span class="string">"/topic/response1"</span>, <span class="function"><span class="keyword">function</span> (<span class="params">msg</span>) </span>&#123;<span class="comment">//通过stopmClient.subscribe订阅"/topic/response"目标发送的消息，这个路径是在控制器的@SendTo中定义的  </span></span><br><span class="line">                <span class="comment">//console.log("ack " + msg.ack());</span></span><br><span class="line">                <span class="keyword">var</span> msgDom = <span class="built_in">document</span>.getElementById(<span class="string">"msg"</span>);</span><br><span class="line">                <span class="keyword">var</span> html = msgDom.innerHTML;</span><br><span class="line">                msgDom.innerHTML = html + <span class="string">"\n"</span> + msg.body;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<p>5、用户事件监听</p>
<p>对用户的连接，订阅、取消订阅、断开等事件监听。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">  <span class="meta">@EventListener</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onConnectEvent</span><span class="params">(SessionConnectEvent event)</span> </span>&#123;</span><br><span class="line">	logger.info(<span class="string">"Client with username &#123;&#125; Connect"</span>, event.getUser().getName());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@EventListener</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSubscribeEvent</span><span class="params">(SessionSubscribeEvent event)</span> </span>&#123;</span><br><span class="line">	logger.info(<span class="string">"Client with username &#123;&#125; Subscribe"</span>, event.getUser().getName());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@EventListener</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onUnsubscribeEvent</span><span class="params">(SessionUnsubscribeEvent event)</span> </span>&#123;</span><br><span class="line">	logger.info(<span class="string">"Client with username &#123;&#125; Unsubscribe"</span>, event.getUser().getName());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@EventListener</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDisconnectEvent</span><span class="params">(SessionDisconnectEvent event)</span> </span>&#123;</span><br><span class="line">	<span class="comment">//event.getUser()</span></span><br><span class="line">	logger.info(<span class="string">"Client with username &#123;&#125; disconnected"</span>, event.getSessionId());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>6、Controller</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebSocketController</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger logger = LoggerFactory.getLogger(WebSocketController<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">	</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">	<span class="keyword">private</span> SimpMessagingTemplate messagingTemplate;<span class="comment">// spring实现的一个发送模板类</span></span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">     <span class="keyword">private</span> SimpUserRegistry userRegistry; <span class="comment">// 可获取连接用户</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/index"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">index</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"index"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@MessageMapping</span>(<span class="string">"/test"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">toAppTest</span><span class="params">(RequestMessage message)</span> </span>&#123;</span><br><span class="line">		System.out.println(message.getMessage());</span><br><span class="line">		<span class="keyword">this</span>.messagingTemplate.convertAndSend(<span class="string">"/topic/response1"</span>, message.getMessage());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 当浏览器向服务端发送请求时，通过@MessageMapping映射的地址，类似于@RequestMapping</span></span><br><span class="line">	<span class="meta">@MessageMapping</span>(value = <span class="string">"/message/test"</span>)</span><br><span class="line">    <span class="comment">// 当服务端有消息时，会对订阅了@SendTo中的路径的浏览器发送消息</span></span><br><span class="line">	<span class="meta">@SendTo</span>(value = <span class="string">"/topic/response1"</span>) </span><br><span class="line">	<span class="function"><span class="keyword">public</span> ResponseMessage <span class="title">say</span><span class="params">(Principal principal, RequestMessage acceptor)</span> </span>&#123;</span><br><span class="line">		System.out.println(principal.getName() + <span class="string">" : "</span> + acceptor.getMessage());</span><br><span class="line">		System.out.println(<span class="string">"连接人数: "</span> + userRegistry.getUserCount());</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> ResponseMessage(principal.getName() + <span class="string">" : "</span> + acceptor.getMessage());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@RequestMapping</span>(value = <span class="string">"/greetings"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">greetings</span><span class="params">(@RequestParam String message)</span> </span>&#123;</span><br><span class="line">		System.out.println(message);</span><br><span class="line">		<span class="keyword">this</span>.messagingTemplate.convertAndSend(<span class="string">"/topic/response1"</span>, message);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RequestMessage</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/***</span></span><br><span class="line"><span class="comment">	 * 请求消息实体</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">private</span> String message;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getMessage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> message;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMessage</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.message = message;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>7、html页面</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns</span>=<span class="string">"http://www.thymeleaf.org"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>websocket<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">onload</span>=<span class="string">"disconnect()"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"connect()"</span> <span class="attr">id</span>=<span class="string">"connect"</span>&gt;</span>连接<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"disconnect()"</span> <span class="attr">id</span>=<span class="string">"disconnect"</span>&gt;</span>断开<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"inputDiv"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"name"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"send"</span> <span class="attr">onclick</span>=<span class="string">"send()"</span>&gt;</span>发送<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"appTest"</span> <span class="attr">onclick</span>=<span class="string">"appTest()"</span>&gt;</span>系统消息<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"msg"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./stomp.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> stompClient = <span class="literal">null</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">	<span class="comment">//设置连接状态控制显示隐藏</span></span></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">setConnected</span><span class="params">(connected)</span></span></span></span><br><span class="line">    &#123;</span><br><span class="line">		</span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.getElementById(<span class="string">"connect"</span>).disabled=connected;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.getElementById(<span class="string">"disconnect"</span>).disabled=!connected;</span></span><br><span class="line">        if(!connected) &#123;</span><br><span class="line"><span class="javascript">			<span class="built_in">document</span>.getElementById(<span class="string">"inputDiv"</span>).style.display=<span class="string">"none"</span>;</span></span><br><span class="line"><span class="actionscript">        &#125;<span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="javascript">			<span class="built_in">document</span>.getElementById(<span class="string">"inputDiv"</span>).style.display=<span class="string">""</span>;</span></span><br><span class="line">        &#125;</span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.getElementById(<span class="string">"msg"</span>).innerHTML = <span class="string">""</span>;</span></span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">connect</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">    	 <span class="keyword">var</span> headers = &#123;</span></span><br><span class="line"><span class="actionscript">    			  sessionId: <span class="string">'111'</span>,</span></span><br><span class="line"><span class="actionscript">    		      passcode: <span class="string">'mypasscode'</span>,</span></span><br><span class="line"><span class="actionscript">    		      <span class="comment">// additional header</span></span></span><br><span class="line"><span class="actionscript">    		      <span class="string">'sessionId'</span>: <span class="string">'my-client-id'</span>,</span></span><br><span class="line"><span class="actionscript">    		      <span class="string">'nickName'</span> : <span class="string">'大虾'</span></span></span><br><span class="line">    		    &#125;;</span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> socket = <span class="keyword">new</span> SockJS(<span class="string">"/eyeshot/portfolio"</span>);<span class="comment">//连接SockJS的endpoint名称为"/portfolio"</span></span></span><br><span class="line"><span class="actionscript">        stompClient = Stomp.over(socket);<span class="comment">//使用STOMP子协议的WebSocket客户端</span></span></span><br><span class="line"><span class="actionscript">        stompClient.connect(headers, <span class="function"><span class="keyword">function</span> <span class="params">(frame)</span> </span>&#123;<span class="comment">//连接WebSocket服务端</span></span></span><br><span class="line"><span class="actionscript">           setConnected(<span class="literal">true</span>);</span></span><br><span class="line"><span class="actionscript">		   stompClient.subscribe(<span class="string">"/topic/response1"</span>, <span class="function"><span class="keyword">function</span> <span class="params">(msg)</span> </span>&#123;<span class="comment">//通过stopmClient.subscribe订阅"/topic/response"目标发送的消息，这个路径是在控制器的@SendTo中定义的  </span></span></span><br><span class="line"><span class="actionscript">                <span class="comment">//console.log("ack " + msg.ack());</span></span></span><br><span class="line"><span class="javascript">                <span class="keyword">var</span> msgDom = <span class="built_in">document</span>.getElementById(<span class="string">"msg"</span>);</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">var</span> html = msgDom.innerHTML;</span></span><br><span class="line"><span class="actionscript">                msgDom.innerHTML = html + <span class="string">"\n"</span> + msg.body;</span></span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">	<span class="comment">//断开连接</span></span></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">disconnect</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">if</span>(stompClient!=<span class="literal">null</span>)&#123;</span></span><br><span class="line">            stompClient.disconnect();</span><br><span class="line">        &#125;</span><br><span class="line"><span class="actionscript">		 setConnected(<span class="literal">false</span>);</span></span><br><span class="line"><span class="javascript">		 <span class="built_in">console</span>.log(<span class="string">"disconnected!"</span>);</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">	<span class="comment">//发送名称到后台</span></span></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">send</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> name = <span class="built_in">document</span>.getElementById(<span class="string">"name"</span>).value;</span></span><br><span class="line"><span class="javascript">        stompClient.send(<span class="string">"/app/message/test"</span>, &#123;&#125;, <span class="built_in">JSON</span>.stringify(&#123;<span class="comment">//通过stompClient.send向"/message/test"目标发送消息，这个在控制器的@MessageMapping中定义的。</span></span></span><br><span class="line"><span class="actionscript">            <span class="string">'message'</span>: name</span></span><br><span class="line">        &#125;));</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">appTest</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> name = <span class="built_in">document</span>.getElementById(<span class="string">"name"</span>).value;</span></span><br><span class="line"><span class="javascript">        stompClient.send(<span class="string">"/app/test"</span>, &#123;&#125;, <span class="built_in">JSON</span>.stringify(&#123;<span class="comment">//通过stompClient.send向"/message/test"目标发送消息，这个在控制器的@MessageMapping中定义的。</span></span></span><br><span class="line"><span class="actionscript">            <span class="string">'message'</span>: name</span></span><br><span class="line">        &#125;));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>





<p>关于controller映射路径参考：<a href="http://www.rabbitmq.com/stomp.html#d">http://www.rabbitmq.com/stomp.html#d</a></p>
<p><a href="https://juejin.im/post/5ac8d30151882548fe4a6143">https://juejin.im/post/5ac8d30151882548fe4a6143</a></p>
</div></article></div><nav class="pagination is-centered mt-4" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/page/10/">Previous</a></div><div class="pagination-next"><a href="/page/12/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/">1</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/10/">10</a></li><li><a class="pagination-link is-current" href="/page/11/">11</a></li><li><a class="pagination-link" href="/page/12/">12</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/28/">28</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><!--!--><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="is-rounded" src="https://cdn.jsdelivr.net/gh/removeif/removeif.github.io@latest/img/avatar.jpg" alt="辣椒の酱"></figure><p class="title is-size-4 is-block line-height-inherit">辣椒の酱</p><p class="is-size-6 is-block">尚未执佩剑，转眼即江湖</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>阿尔及利亚</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">276</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">43</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">93</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://weibo.com/u/3050419984" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-white is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/removeif"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-white is-marginless" target="_blank" rel="noopener" title="Weibo" href="https://weibo.com/u/3050419984"><i class="fab fa-weibo"></i></a><a class="level-item button is-transparent is-white is-marginless" target="_blank" rel="noopener" title="Email" href="mailto:removeif@163.com"><i class="fa fa-envelope"></i></a><a class="level-item button is-transparent is-white is-marginless" target="_blank" rel="noopener" title="Next" href="https://removeif.github.io/remove.io"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-white is-marginless" target="_blank" rel="noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div><div><hr><p id="hitokoto">:D 一言句子获取中...</p><script type="text/javascript" defer>function getYiyan(){
                                $.getJSON("https://v1.hitokoto.cn/", function (data) {
                                if(data){
                                    $('#hitokoto').html("");
                                    $('#hitokoto').append("<strong style='color: #3273dc;'>"+data.hitokoto+"</strong>"+
                                    "<p>"+"来源《"+data.from+"》</p><p>提供者-"+data.creator+"</p>");
                                }});}
                                $(function (){getYiyan();$('#hitokoto').click(function(){getYiyan();})});</script></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget"><div class="card-content"><h3 class="menu-label">最新评论</h3><span class="body_hot_comment">加载中，最新评论有1分钟延迟...</span></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">Recent</h3><article class="media"><div class="media-content size-small"><p><time dateTime="2020-05-22T16:00:00.000Z">2020-05-23</time></p><p class="title is-6"><a class="link-muted" href="/2020/05/23/Jenkins/%E5%89%8D%E7%AB%AF%E6%96%87%E4%BB%B6%E6%9B%B4%E6%96%B0%E6%96%B9%E6%A1%88/">前端文件更新方案</a></p><p class="is-uppercase"><i class="fas fa-folder-open has-text-grey"> </i><a class="link-muted" href="/categories/Jenkins/">Jenkins</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-04-28T16:00:00.000Z">2020-04-29</time></p><p class="title is-6"><a class="link-muted" href="/2020/04/29/nginx/echo-nginx-module%E6%A8%A1%E5%9D%97/">echo-nginx-module模块</a></p><p class="is-uppercase"><i class="fas fa-folder-open has-text-grey"> </i><a class="link-muted" href="/categories/nginx/">nginx</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-04-27T16:00:00.000Z">2020-04-28</time></p><p class="title is-6"><a class="link-muted" href="/2020/04/28/nginx/%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/nginx%E5%9C%A8%E8%AF%B7%E6%B1%82%E8%B7%AF%E5%BE%84%E4%B8%AD%E4%BF%AE%E6%94%B9%E5%AD%97%E7%AC%A6%E4%B8%B2/">nginx在请求路径中修改字符串</a></p><p class="is-uppercase"><i class="fas fa-folder-open has-text-grey"> </i><a class="link-muted" href="/categories/nginx/">nginx</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-04-19T16:00:00.000Z">2020-04-20</time></p><p class="title is-6"><a class="link-muted" href="/2020/04/20/%E5%B7%A5%E4%BD%9C/java%E6%9C%8D%E5%8A%A1CPU%E5%8D%A0%E7%94%A8%E9%AB%98/">java服务CPU占用高</a></p><p class="is-uppercase"><i class="fas fa-folder-open has-text-grey"> </i><a class="link-muted" href="/categories/%E5%B7%A5%E4%BD%9C/">工作</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-04-18T16:00:00.000Z">2020-04-19</time></p><p class="title is-6"><a class="link-muted" href="/2020/04/19/%E5%B7%A5%E4%BD%9C/java%E6%9C%8D%E5%8A%A1%E5%86%85%E5%AD%98%E5%8D%A0%E7%94%A8%E5%AE%9A%E4%BD%8D/">java服务内存占用定位</a></p><p class="is-uppercase"><i class="fas fa-folder-open has-text-grey"> </i><a class="link-muted" href="/categories/%E5%B7%A5%E4%BD%9C/">工作</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/Elasticsearch/"><span class="level-start"><span class="level-item">Elasticsearch</span></span><span class="level-end"><span class="level-item tag">21</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/HTTPS/"><span class="level-start"><span class="level-item">HTTPS</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Java/"><span class="level-start"><span class="level-item">Java</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Java%E5%9F%BA%E7%A1%80/"><span class="level-start"><span class="level-item">Java基础</span></span><span class="level-end"><span class="level-item tag">15</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Jenkins/"><span class="level-start"><span class="level-item">Jenkins</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Linux/"><span class="level-start"><span class="level-item">Linux</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/MongoDB/"><span class="level-start"><span class="level-item">MongoDB</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/OCR/"><span class="level-start"><span class="level-item">OCR</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/RabbitMq/"><span class="level-start"><span class="level-item">RabbitMq</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Spring-boot/"><span class="level-start"><span class="level-item">Spring-boot</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><a class="level is-mobile is-marginless" href="/categories/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2020/05/"><span class="level-start"><span class="level-item">May 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/04/"><span class="level-start"><span class="level-item">April 2020</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/03/"><span class="level-start"><span class="level-item">March 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/01/"><span class="level-start"><span class="level-item">January 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/12/"><span class="level-start"><span class="level-item">December 2019</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><a class="level is-mobile is-marginless" href="/archives/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Elasticsearch/"><span class="tag">Elasticsearch</span><span class="tag is-grey-lightest">21</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/"><span class="tag">搜索引擎</span><span class="tag is-grey-lightest">18</span></a></div><div class="control"><a class="tags has-addons" href="/tags/IO%E6%B5%81/"><span class="tag">IO流</span><span class="tag is-grey-lightest">15</span></a></div><div class="control"><a class="tags has-addons" href="/tags/linux/"><span class="tag">linux</span><span class="tag is-grey-lightest">15</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%B7%A5%E4%BD%9C/"><span class="tag">工作</span><span class="tag is-grey-lightest">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MongoDB/"><span class="tag">MongoDB</span><span class="tag is-grey-lightest">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/20%E5%A4%A9/"><span class="tag">20天</span><span class="tag is-grey-lightest">12</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nginx/"><span class="tag">nginx</span><span class="tag is-grey-lightest">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%9B%86%E5%90%88/"><span class="tag">集合</span><span class="tag is-grey-lightest">10</span></a></div><div class="control"><a class="tags has-addons" href="/tags/java/"><span class="tag">java</span><span class="tag is-grey-lightest">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mongodb/"><span class="tag">mongodb</span><span class="tag is-grey-lightest">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/21%E5%A4%A9/"><span class="tag">21天</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Spring-boot/"><span class="tag">Spring-boot</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker/"><span class="tag">docker</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Jenkins/"><span class="tag">Jenkins</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/json/"><span class="tag">json</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/redis/"><span class="tag">redis</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rsync/"><span class="tag">rsync</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%91%BD%E4%BB%A4/"><span class="tag">命令</span><span class="tag is-grey-lightest">5</span></a></div></div><div class="field is-grouped is-grouped-multiline"><a class="tags has-addons" href="/tags/"><span class="tag">查看全部&gt;&gt;</span></a></div></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe to Updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=removeifFeedsId&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="removeifFeedsId" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button is-primary" type="submit" value="Subscribe"></div></div><p class="help">输入邮箱开始订阅，更博后邮件通知！</p></form></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="https://cdn.jsdelivr.net/gh/removeif/blog_image/img/2019/20191121122803.png" alt="Hexoqzf" height="28"></a><p class="size-small"><span>&copy; 2020 qzf</span>  Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a>,Modify by <a href="https://github.com/removeif" target="_blank">removeif</a> <br>© 版权说明：[本网站所有内容均收集于互联网或自己创作,<br>    方便于网友与自己学习交流，如有侵权，请<a href="/message" target="_blank">留言</a>，立即处理]<br><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/removeif/removeif.github.io@v2.2.1/js/statistics.js"></script><span id="statistic-times">网站运行时间统计加载中...</span><br><div class="size-small"><span id="busuanzi_container_site_uv">❤️感谢<strong> <span id="busuanzi_value_site_uv">99+</span> </strong></span>小伙伴的<strong> <span id="busuanzi_value_site_pv">99+</span> </strong>次光临，查看💐<a href="https://github.com/removeif/hexo-theme-amazing" target="_blank">主题源码</a>！❤️</div></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/removeif"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'http://yoursite.com',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="https://cdn.jsdelivr.net/gh/removeif/removeif.github.io@v2.2.1/js/animation.js"></script><a id="back-to-top" title="Back to Top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="https://cdn.jsdelivr.net/gh/removeif/removeif.github.io@v2.2.1/js/back-to-top.js" defer></script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/gh/removeif/removeif.github.io@v2.2.1/js/gallery.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/gh/removeif/removeif.github.io@v2.2.1/js/main.js" defer></script><script src="https://cdn.jsdelivr.net/gh/removeif/removeif.github.io@v2.2.1/js/comment-issue-data.js" defer></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/removeif/removeif.github.io@v2.2.1/css/insight.css"><div class="searchbox ins-search"><div class="searchbox-container ins-search-container"><div class="searchbox-input-wrapper"><input class="searchbox-input ins-search-input" type="text" placeholder="Type something..."><span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span></div><div class="searchbox-result-wrapper ins-section-wrapper"><div class="ins-section-container"></div></div></div></div><script>(function (window) {
            var INSIGHT_CONFIG = {
                TRANSLATION: {
                    POSTS: 'Posts',
                    PAGES: 'Pages',
                    CATEGORIES: 'Categories',
                    TAGS: 'Tags',
                    UNTITLED: '(Untitled)',
                },
                CONTENT_URL: 'https://cdn.jsdelivr.net/gh/removeif/removeif.github.io@v2.2.1/content.json',
            };
            window.INSIGHT_CONFIG = INSIGHT_CONFIG;
        })(window);</script><script src="https://cdn.jsdelivr.net/gh/removeif/removeif.github.io@v2.2.1/js/insight.js" defer></script></body></html>